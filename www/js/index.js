(()=>{"use strict";class e{_marque;_quantite;static crayonList=document.querySelector("#crayonList");static crayonType=["bille","plume","couleur","feutre","bois"];constructor(e,t){this._marque=e,this._quantite=t}async getCrayons(){const t=await fetch("http://localhost:3000/crayons",{method:"GET",headers:{"Content-Type":"application/json"}});(await t.json()).forEach((t=>{document.querySelector(".liste-crayon");const n=document.createElement("ion-item");n.innerHTML=`\n      <div class="crayon" id="${t.id}">\n        <ion-label>\n          <h2>Modèle : ${t.marque}</h2>\n          <h3>Type : ${t.type}</h3>\n          <p>Quantité : ${t.quantite}</p>\n          <ion-button data-id="${t.id}" class="modifier"><ion-icon slot="icon-only" name="build" ></ion-icon></ion-button>\n          <ion-button class="supprimer"><ion-icon slot="icon-only" name="trash-bin"></ion-icon></ion-button>\n        </ion-label>\n      </div>\n      `,e.crayonList.insertBefore(n,e.crayonList.firstElementChild)}))}async deleteCrayon(){const e=document.querySelector(".crayon");e&&await fetch("http://localhost:3000/crayons/"+e.id,{method:"DELETE"}).then((()=>{window.alert("Crayon supprimé"),window.location.reload()}))}async promptCrayon(t="Ajouter un crayon",n=!0,o=!1,i){const a=document.createElement("ion-alert");a.header=t,a.mode="ios",n?(a.inputs=[{type:"text",name:"marque",placeholder:"Indiquez la marque",maxlength:50},{type:"number",name:"quantite",placeholder:"Quantité",min:1}],a.buttons=[{text:"Go !",handler:e=>{this._marque=e.marque,this._quantite=e.quantite}}]):(a.inputs=e.crayonType.map((e=>({type:"radio",value:e,label:e}))),a.buttons=[{text:"Go !",handler:e=>{if(o){let t={marque:this._marque,type:e,quantite:this._quantite};fetch("http://localhost:3000/crayons/"+i,{method:"PATCH",headers:{"content-type":"application/json"},body:JSON.stringify(t)}).then((()=>{window.alert("Le crayon a bien été modifié"),window.location.reload()}))}else{let t={marque:this._marque,type:e,quantite:this._quantite};fetch("http://localhost:3000/crayons",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)}).then((()=>{window.alert("Le crayon a bien été créé"),window.location.reload()}))}}}]),document.body.appendChild(a),await a.present(),n&&a.onDidDismiss().then((()=>this.promptCrayon("Ajouter une quantité",!1,o,i)))}}document.addEventListener("deviceready",(async function(){const t=new e;await t.getCrayons(),window.addEventListener("batterystatus",(function(e){document.querySelector("#battery").innerHTML='<ion-icon name="battery-half-outline"></ion-icon>'+e.level+"%"}),!1);const n=document.querySelectorAll(".supprimer"),o=document.querySelectorAll(".modifier"),i=document.querySelector("#addCrayon"),a=document.querySelector(".accueil"),r=document.querySelector(".ajout-crayon"),c=document.querySelector(".liste-crayon"),d=document.getElementById("accueil"),l=document.getElementById("ajout-crayon"),s=document.getElementById("liste-crayon");d.hidden=!1,l.hidden=!0,s.hidden=!0,a.addEventListener("click",(()=>{!0===d.hidden&&(d.hidden=!1,l.hidden=!0,s.hidden=!0)})),r.addEventListener("click",(()=>{!0===l.hidden&&(l.hidden=!1,s.hidden=!0,d.hidden=!0)})),c.addEventListener("click",(()=>{!0===s.hidden&&(s.hidden=!1,d.hidden=!0,l.hidden=!0)})),n.forEach((e=>{e.addEventListener("click",(()=>{t.deleteCrayon()}))})),i.addEventListener("click",(()=>{t.promptCrayon()})),o.forEach((e=>{e.addEventListener("click",(()=>{const n=e.dataset.id;t.promptCrayon("Modifier un crayon",!0,!0,n)}))}))}),!1)})();